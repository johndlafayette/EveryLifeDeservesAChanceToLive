<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Every Life</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;1,300;1,400&family=Bebas+Neue&display=swap');

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  html, body {
    width: 100%; height: 100%;
    background: #060606;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-family: 'Cormorant Garamond', serif;
    color: #f0ede6;
    overflow: hidden;
    user-select: none;
  }

  /* ‚îÄ‚îÄ Ring countdown ‚îÄ‚îÄ */
  #ring-wrap {
    position: relative;
    width: 180px;
    height: 180px;
    margin-bottom: 36px;
  }

  #ring-svg {
    width: 180px;
    height: 180px;
    transform: rotate(-90deg);
  }

  #ring-bg {
    fill: none;
    stroke: rgba(255,255,255,0.06);
    stroke-width: 2;
  }

  #ring-fill {
    fill: none;
    stroke: rgba(255,255,255,0.55);
    stroke-width: 1.5;
    stroke-linecap: round;
    stroke-dasharray: 408;
    stroke-dashoffset: 408;
    transition: stroke-dashoffset 0.25s linear, stroke 0.5s ease;
  }

  #ring-center {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 2px;
  }

  #ring-time {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 2.6rem;
    letter-spacing: 0.08em;
    color: rgba(255,255,255,0.85);
    line-height: 1;
  }

  #ring-sub {
    font-family: 'Cormorant Garamond', serif;
    font-style: italic;
    font-size: 0.7rem;
    letter-spacing: 0.2em;
    color: rgba(255,255,255,0.25);
  }

  /* ‚îÄ‚îÄ Status ‚îÄ‚îÄ */
  #status {
    font-family: 'Cormorant Garamond', serif;
    font-style: italic;
    font-size: 0.8rem;
    letter-spacing: 0.2em;
    color: rgba(255,255,255,0.25);
    margin-bottom: 36px;
    height: 1.2em;
    text-align: center;
    transition: color 0.8s ease;
  }
  #status.lit { color: rgba(255,255,255,0.6); }

  /* ‚îÄ‚îÄ Main button ‚îÄ‚îÄ */
  #main-btn {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1rem;
    letter-spacing: 0.25em;
    background: transparent;
    border: 1px solid rgba(255,255,255,0.3);
    color: #f0ede6;
    padding: 14px 44px;
    cursor: pointer;
    text-transform: uppercase;
    text-decoration: none;
    display: inline-block;
    transition: all 0.3s ease;
  }
  #main-btn:hover { background: rgba(255,255,255,0.07); border-color: rgba(255,255,255,0.8); }
  #main-btn.done { opacity: 0.3; pointer-events: none; font-size: 0.85rem; padding: 14px 28px; }

  /* ‚îÄ‚îÄ Flash overlay (fires at 5:00) ‚îÄ‚îÄ */
  #flash {
    position: fixed;
    inset: 0;
    background: #fff;
    opacity: 0;
    pointer-events: none;
    z-index: 100;
    transition: opacity 0.08s ease;
  }

  /* ‚îÄ‚îÄ Instruction hint ‚îÄ‚îÄ */
  #hint {
    position: fixed;
    bottom: 28px;
    font-family: 'Cormorant Garamond', serif;
    font-style: italic;
    font-size: 0.7rem;
    letter-spacing: 0.18em;
    color: rgba(255,255,255,0.12);
    text-align: center;
    padding: 0 24px;
    transition: color 1s ease;
  }
  #hint.lit { color: rgba(255,255,255,0.35); }

  /* ‚îÄ‚îÄ Alert banner at 5:00 ‚îÄ‚îÄ */
  #alert-banner {
    position: fixed;
    top: 0; left: 0; right: 0;
    background: rgba(255,255,255,0.95);
    color: #000;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1rem;
    letter-spacing: 0.3em;
    text-align: center;
    padding: 14px;
    transform: translateY(-100%);
    transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    z-index: 50;
  }
  #alert-banner.show { transform: translateY(0); }
</style>
</head>
<body>

<div id="flash"></div>
<div id="alert-banner">üëÅ SWITCH TO THE NEW TAB NOW</div>

<div id="ring-wrap">
  <svg id="ring-svg" viewBox="0 0 180 180">
    <circle id="ring-bg" cx="90" cy="90" r="65"/>
    <circle id="ring-fill" cx="90" cy="90" r="65"/>
  </svg>
  <div id="ring-center">
    <div id="ring-time">‚Äî:‚Äî‚Äî</div>
    <div id="ring-sub">waiting</div>
  </div>
</div>

<div id="status">open the song ¬∑ come back here ¬∑ watch the ring</div>

<a id="main-btn"
   href="https://www.youtube.com/watch?v=hRXc_-c_9Xc&t=255s"
   target="_blank"
   onclick="onSongOpen()">
  ‚ñ∂ Open We Exist on YouTube
</a>

<div id="hint">keep this tab open in the background</div>

<script>
  const SWITCH_AT    = 45;       // seconds (4:15 ‚Üí 5:00)
  const CIRCUMFERENCE = 2 * Math.PI * 65; // ‚âà 408.4

  let startTime = null;
  let ticker    = null;
  let fired     = false;

  const ringFill    = document.getElementById('ring-fill');
  const ringTime    = document.getElementById('ring-time');
  const ringSub     = document.getElementById('ring-sub');
  const statusEl    = document.getElementById('status');
  const mainBtn     = document.getElementById('main-btn');
  const flash       = document.getElementById('flash');
  const alertBanner = document.getElementById('alert-banner');
  const hint        = document.getElementById('hint');

  ringFill.style.strokeDasharray  = CIRCUMFERENCE;
  ringFill.style.strokeDashoffset = CIRCUMFERENCE;

  function pad(n) { return String(Math.floor(n)).padStart(2,'0'); }
  function fmt(s) { return `${pad(s/60)}:${pad(s%60)}`; }

  function onSongOpen() {
    setTimeout(() => {
      mainBtn.textContent = '‚ô´ Song open ‚Äî press play on YouTube';
      mainBtn.classList.add('done');
      statusEl.textContent = '‚ô´ counting down to 5:00';
      statusEl.classList.add('lit');
      hint.classList.add('lit');
      startTime = Date.now();
      ticker = setInterval(tick, 100);
    }, 300);
  }

  function tick() {
    const elapsed   = (Date.now() - startTime) / 1000;
    const remaining = Math.max(0, SWITCH_AT - elapsed);
    const pct       = Math.min(elapsed / SWITCH_AT, 1);
    const offset    = CIRCUMFERENCE * (1 - pct);

    // Update ring
    ringFill.style.strokeDashoffset = offset;
    ringTime.textContent = fmt(255 + elapsed);
    ringSub.textContent  = Math.ceil(remaining) + 's';

    // Color ring red in final 10s
    if (remaining <= 10) {
      ringFill.style.stroke = `rgba(255,${Math.floor(180 * (remaining/10))},${Math.floor(100 * (remaining/10))},0.85)`;
      ringSub.style.color = 'rgba(255,150,100,0.6)';
    }

    if (!fired && elapsed >= SWITCH_AT) {
      fired = true;
      clearInterval(ticker);
      triggerSwitch();
    }
  }

  function triggerSwitch() {
    // 1. Open womb video in new tab (muted)
    window.open('https://www.youtube.com/shorts/32JCR69CJvo', '_blank');

    // 2. Flash the screen white
    flash.style.opacity = '1';
    setTimeout(() => { flash.style.opacity = '0'; }, 180);

    // 3. Show alert banner
    alertBanner.classList.add('show');

    // 4. Chime via Web Audio API
    playChime();

    // 5. Flash tab title repeatedly
    ringTime.textContent = '5:00';
    ringSub.textContent  = '‚Üó switch tab';
    statusEl.textContent = 'womb video opened ‚Äî switch to new tab';

    let titleFlash = true;
    const titleTicker = setInterval(() => {
      document.title = titleFlash ? 'üëÅ SWITCH TAB NOW' : 'Every Life';
      titleFlash = !titleFlash;
    }, 600);

    // Stop flashing after 12 seconds
    setTimeout(() => {
      clearInterval(titleTicker);
      document.title = 'Every Life';
      alertBanner.classList.remove('show');
    }, 12000);
  }

  function playChime() {
    try {
      const ctx  = new (window.AudioContext || window.webkitAudioContext)();
      // Three ascending tones
      [[523, 0], [659, 0.18], [784, 0.36]].forEach(([freq, delay]) => {
        const osc  = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.connect(gain);
        gain.connect(ctx.destination);
        osc.type = 'sine';
        osc.frequency.setValueAtTime(freq, ctx.currentTime + delay);
        gain.gain.setValueAtTime(0, ctx.currentTime + delay);
        gain.gain.linearRampToValueAtTime(0.28, ctx.currentTime + delay + 0.05);
        gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + delay + 0.9);
        osc.start(ctx.currentTime + delay);
        osc.stop(ctx.currentTime + delay + 0.9);
      });
    } catch(e) {}
  }
</script>
</body>
</html>
